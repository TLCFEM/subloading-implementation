\section{Subloading Surface Model}
In this section, the framework of the (extended) subloading surface model is briefly reviewed and summarised.
\subsection{The Subloading Surface}
The conventional plasticity models often adopt the concept of the yield surface, denoted by $f\left(\bsigma,\cdots\right)$, which defines the frontier/boundary of plasticity.
For example,
\begin{gather}
    f=\norm{\beeta}-F,
\end{gather}
in which $\beeta=\beeta\left(\bsigma,\cdots\right)$ is known as the shifted stress that shall be a function of the stress $\bsigma$ and other internal variables, $F=F\left(q\right)$ characterises the size of the surface and could evolve with the development of plasticity driven by some internal variable $q$.
Within the yield surface, the material is elastic, while plasticity would develop once the stress state reaches the yield surface.
Thus, any admissible state shall satisfy the inequality $f\leqslant0$.

The original proposal of the subloading surface model introduces the concept of the normal yield ratio, denoted by $z$ in this work, which effectively scales the yield surface $f$ down by a factor of $z$, the new surface is call the subloading surface $f_s$ and it is concentric with the yield surface $f$.
\begin{gather}
    f_s=\norm{\beeta}-zF.
\end{gather}
The normal yield ratio $0\leqslant{}z\leqslant{}1$ shall be updated in a manner such that $f_s=0$ is enforced not only for plastic loading but also for elastic unloading.
With such a construct, any given stress state would always lie on the subloading surface, meaning that $f_s=0$ is always satisfied.

The main shortcoming of the original subloading surface model is that it exhibits excessive strain accumulation under cyclic loading.
To address this issue, the extended subloading surface model introduces the concept of the elastic core.
An additional internal field, denoted by $\bc$, is adopted to define the elastic core surface, which is concentric with the yield surface (centred at the back stress $\bbeta$).

The subloading surface is then pulled from the original centre $\bbeta$ towards $\bc$ by a certain amount governed by the normal yield ratio $z$.
\begin{figure}[htb]
    \centering\footnotesize
    \begin{tikzpicture}[>=latex]
        \newcommand{\Ax}{2.8}
        \newcommand{\Ay}{3}
        \newcommand{\Bx}{6}
        \newcommand{\By}{3.8}
        \pgfmathsetmacro{\RR}{sqrt((\Bx-\Ax)^2+(\By-\Ay)^2)}
        \draw[->](-.5,0)--(3,0);
        \draw[->](0,-.5)--(0,3);
        \coordinate(A)at(\Ax,\Ay);
        \coordinate(B)at(\Bx,\By);
        \coordinate(C)at($(A)!0.375!(B)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \draw[dashed,draw,line width=.3mm](A)circle(4cm);
        \draw[dotted,draw,line width=.3mm](A)circle(2.5cm);
        \draw[draw,line width=.6mm](C)circle(2.5cm);
        \draw[->,red,line width=.4mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta$};
        \draw[->,red,line width=.6mm](A)--(B);
        \draw[->,red,line width=.4mm](0,0)--(B)node[midway,fill=white,sloped]{$\bc$};
        \draw[->,blue,line width=.8mm](A)--(C);
        \draw[|<->|](A)--++(140:4)node[midway,fill=white,sloped]{$F$};
        \draw[|<->|](C)--++(140:2.5)node[midway,fill=white,sloped]{$zF$};
        \draw[<-]($(A)+(60:4)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        \draw[<-]($(A)+(60:2.5)$)--++(60:1)--++(2,0)node[right,fill=white,align=left]{subloading surface\\in the original proposal};
        \draw[<-]($(C)+(60:2.5)$)--++(60:1.7)--++(1,0)node[right,fill=white,align=left]{subloading surface\\in the extended version};
        \draw[<-]($(C)!0.5!(B)$)--++(-60:1.5)--++(2,0)node[right,fill=white]{$z\left(\bc-\bbeta\right)$};
        \draw[<-]($(A)!0.5!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)\left(\bc-\bbeta\right)$};
        \draw[black!20]($(A)+(140:4)$)--(B);
    \end{tikzpicture}
    \caption{graphical representation of the surfaces used in the subloading surface model}\label{fig:surfaces}
\end{figure}
A graphical illustration is shown in \figref{fig:surfaces}.
By definition, $\bc$ denotes the homothetic centre between $f$ and $f_s$.
Then, according to similarity, the new centre of the subloading surface is $\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)$, that is $z\bbeta+\left(1-z\right)\bc$.
\subsection{Original Evolution Rules}
The original formulation further imposes the requirement such that the size of the elastic core shall be limited to a certain fraction of that of the yield surface.
This is achieved by the following evolution rule for $\bc$ \citep{Anjiki2019,Hashiguchi2023},
\begin{gather}\label{eq:original_core}
    \dot{\bc}=c_e\gamma\left(z_eF\bn-\left(\bc-\bbeta\right)\right)+\dot{\bbeta}+\dfrac{\dot{F}}{F}\left(\bc-\bbeta\right).
\end{gather}
In which, $0\leqslant{}c_e$ is a constant that controls the evolution rate, $0\leqslant{}z_e\leqslant1$ is a constant that controls the limit size of the elastic core, $\gamma$ is the plastic multiplier and $\bn=\pdfrac{f_s}{\bsigma}/\norm{\pdfrac{f_s}{\bsigma}}$ is unit gradient of the subloading surface.

The evolution rule for the normal yield ratio $z$ is given by
\begin{gather}\label{eq:original_z}
    \dot{z}=U\dot{q},
\end{gather}
where $U=U\left(z\right)$ is a function that shall satisfy certain conditions, and $q$ is the accumulated plastic strain.

Both of the above evolution rules will be discussed and refined in the following sections.
Here, we only present them in there original form for completeness.
\section{A Revised Formulation}
\subsection{Preliminary Remarks}
In the scalar form, the Armstrong--Frederick evolution rule \citep{Frederick2007} is equivalent to the following ordinary differential equation (ODE),
\begin{equation}
    y'=b\left(a-y\right),
\end{equation}
it can be explicitly integrated to give the solution for the initial condition $y(0)=0$,
\begin{equation}
    y(x)=a\left(1-\exp\left(-bx\right)\right),
\end{equation}
which defines a curve that asymptotically approaches the constant bound $a$.

To employ a non-constant bound, it is possible to simply replace the constant $a$ by a function $f(x)$ in the ODE.
However, as noted in the literature, the corresponding solution is not strictly bounded by $f(x)$.
\figref{fig:examples} presents both hardening and softening examples.
\begin{figure}[htb]
    \centering\scriptsize
    \begin{subfigure}{0.45\textwidth}\centering
        \begin{tikzpicture}
            \begin{axis}[axis lines=middle,xlabel=$x$,ylabel=$y$,grid=both,width=6.5cm,height=4.5cm,legend pos=south east,ymin=0,ymax=1.5,scale only axis,enlargelimits=false]
                \pgfmathsetmacro{\aa}{-.05}
                \pgfmathsetmacro{\bb}{1}
                \pgfmathsetmacro{\cc}{1}
                \addplot[domain=0:10,samples=100,color=blue]{\aa*x+\bb};
                \addplot[domain=0:10,samples=100,color=red]{\aa*x+\bb+(\aa/\cc-\bb)*exp(-\cc*x)-\aa/\cc};
                \addlegendentry{$f(x)=\aa{}x+\bb$}
                \addlegendentry{$\dot{y}=\cc\left(f(x)-y\right)$}
            \end{axis}
        \end{tikzpicture}
        \caption{softening}
    \end{subfigure}\hfill
    \begin{subfigure}{0.45\textwidth}\centering
        \begin{tikzpicture}
            \begin{axis}[axis lines=middle,xlabel=$x$,ylabel=$y$,grid=both,width=6.5cm,height=4.5cm,legend pos=south east,ymin=0,ymax=1.5,scale only axis,enlargelimits=false]
                \pgfmathsetmacro{\aa}{0.05}
                \pgfmathsetmacro{\bb}{1}
                \pgfmathsetmacro{\cc}{1}
                \addplot[domain=0:10,samples=100,color=blue]{\aa*x+\bb};
                \addplot[domain=0:10,samples=100,color=red]{\aa*x+\bb+(\aa/\cc-\bb)*exp(-\cc*x)-\aa/\cc};
                \addlegendentry{$f(x)=\aa{}x+\bb$}
                \addlegendentry{$\dot{y}=\cc\left(f(x)-y\right)$}
            \end{axis}
        \end{tikzpicture}
        \caption{hardening}
    \end{subfigure}
    \caption{examples}\label{fig:examples}
\end{figure}
As can be seen from the figure, the solution may overshoot for softening bounds.
Furthermore, in both cases, the solution $y$ does \textbf{not} asymptotically approach the bound $f(x)$.
That is, the following condition does not hold for arbitrarily small $\epsilon$,
\begin{gather}
    \lim\limits_{x\to\infty}\abs{y-f(x)}<\epsilon.
\end{gather}

To ensure that the solution is bounded by $f(x)$, let's consider the following function,
\begin{gather}
    y=f(x)\left(1-\exp\left(-bx\right)\right),
\end{gather}
since $1-\exp\left(-bx\right)\leqslant1$, it is guaranteed that $y\leqslant{}f(x)$.
The corresponding ODE can be derived as follows,
\begin{gather}\label{eq:strict_bound}
    y'=fb\exp\left(-bx\right)+f'\left(1-\exp\left(-bx\right)\right)=b\left(f-y\right)+\dfrac{f'}{f}y.
\end{gather}
After careful comparison, one could observe that \eqsref{eq:strict_bound} is in fact the scalar version of the evolution rule presented in \eqsref{eq:original_core}.
They bear the same format.
\subsubsection{Revised Evolution Rule (Elastic Core)}
The evolution rule for $\bc$ shown in \eqsref{eq:original_core} is derived at the limit state where the subloading surface coincides with the limit surface --- which would not occur due to its asymptotic nature.
It possesses a cumbersome form that involves both $F$ and its derivative.
As a result, it is not straightforward to implement numerically.
Instead, based on the above observations, one can apply the following decomposition,
\begin{gather}\label{eq:decomposition_core}
    \bc-\bbeta=F\bd\qquad\rightarrow\qquad\bc=\bbeta+F\bd,
\end{gather}
then the evolution of $\bc$ can be equivalently described by the evolution of $\bd$, which could take a very simple form as the contribution of $F$ is separated,
\begin{gather}\label{eq:revised_core}
    \dot{\bd}=c_e\left(z_e\bn-\bd\right)\gamma.
\end{gather}
Since the magnitude of $\bd$ defined in this manner is bounded by the constant $z_e$, it is then guaranteed that $\norm{\bc-\bbeta}=F\norm{\bd}\leqslant{}z_eF$.
Such a decomposition separates the directional vector from the scalar magnitude, which allows much simpler evolution rules for both parts, although the vector here does not possess a fixed unit length.
\eqsref{eq:decomposition_core} may be called the `pseudo-polar coordinate' representation.
\subsubsection{Revised Evolution Rule (Back Stress)}
Now since \eqsref{eq:decomposition_core} is adopted, a similar strategy can also be applied to $\bbeta$ to allow its bound to evolve with the development of plasticity, that is,
\begin{gather}\label{eq:decomposition_back}
    \bbeta=H\balpha,
\end{gather}
with $H=H\left(q\right)$ being the bound and $\balpha$ being the normalised back stress (normalised by $H$) which could have the following evolution rule.
\begin{gather}\label{eq:revised_back}
    \dot{\balpha}=b\left(\bn-\balpha\right)\gamma,
\end{gather}
where $b$ is a constant that controls the evolution rate.
Similar to $\norm{\bc-\bbeta}$, here it is guaranteed that $\norm{\bbeta}=H\norm{\balpha}\leqslant{}H$.

It is possible to associate $H$ with $F$ such that $H$ is set to a fraction of $F$.
Here, to allow more flexibility, $H$ is defined as an independent quantity.
Nevertheless, if one wishes, it is possible to associate $H$ with $F$ as done in other work \citep[e.g.,]{Anjiki2019}.
\subsubsection{Shifted Stress}
The original formulation uses the following expression to compute the shifted stress $\beeta$,
\begin{gather}
    \beeta=\bs-\left(\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)\right),
\end{gather}
where $\bs=\bs\left(\bsigma\right)$ is some function of the stress tensor, since now the new centre of the subloading surface is shifted to $\bbeta+\left(1-z\right)\left(\bc-\bbeta\right)$.
Account for the proposed decompositions \eqsref{eq:decomposition_core} and \eqsref{eq:decomposition_back}, the above expression can be rewritten as
\begin{gather}
    \beeta=\bs-H\balpha+\left(z-1\right)F\bd,
\end{gather}
\figref{fig:revised_surfaces} presents a graphical representation of the quantities used in the revised formulation.
\begin{figure}[htb]
    \centering\footnotesize
    \begin{tikzpicture}[>=latex]
        \newcommand{\Ax}{2.8}
        \newcommand{\Ay}{3}
        \newcommand{\Bx}{6}
        \newcommand{\By}{3.8}
        \pgfmathsetmacro{\RR}{sqrt((\Bx-\Ax)^2+(\By-\Ay)^2)}
        \draw[->](-.5,0)--(3,0);
        \draw[->](0,-.5)--(0,3);
        \coordinate(A)at(\Ax,\Ay);
        \coordinate(B)at(\Bx,\By);
        \coordinate(C)at($(A)!0.375!(B)$);
        \coordinate(D)at($(C)+(130:2.5)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(D){};
        \draw[dashed,draw,line width=.3mm](A)circle(4cm);
        \draw[draw,line width=.6mm](C)circle(2.5cm);
        \draw[->,red,line width=1mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta=H\balpha$};
        \draw[->,dotted,red,line width=.4mm](C)--(B);
        \draw[->,red,line width=1mm](A)--(C);
        \draw[->,red,line width=1mm](C)--(D)node[midway,fill=white]{$\beeta$};
        \draw[->,red,line width=1mm](0,0)--(D)node[midway,fill=white,sloped]{$\bs$};
        \draw[|<->|](C)--++(45:2.5)node[midway,fill=white,sloped]{$zF$};
        \draw[<-]($(A)+(60:4)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        \draw[<-]($(C)+(60:2.5)$)--++(60:1.7)--++(1,0)node[right,fill=white]{subloading surface};
        \draw[<-]($(C)!0.5!(B)$)--++(-60:1.5)--++(2,0)node[right,fill=white]{$zF\bd$};
        \draw[<-]($(A)!0.5!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)F\bd$};
    \end{tikzpicture}
    \caption{graphical representation of the surfaces using proposed definitions}\label{fig:revised_surfaces}
\end{figure}
\subsubsection{Loading/Unloading Criterion}
Apart from pure (un)loading, for arbitrary loading directions and magnitudes, there exists possibilities that the normal yield ratio $z$ may decrease first --- the subloading surface shrinks, then increase --- the subloading surface expands.
A graphical representation is shown in \figref{fig:loading_criterion}.
\begin{figure}[htb]
    \centering\footnotesize
    \begin{tikzpicture}[>=latex]
        \newcommand{\Ax}{2.8}
        \newcommand{\Ay}{3}
        \newcommand{\Bx}{6}
        \newcommand{\By}{3.8}
        \newcommand{\DD}{70}
        \pgfmathsetmacro{\RR}{sqrt((\Bx-\Ax)^2+(\By-\Ay)^2)}
        \draw[->](-.5,0)--(2,0);
        \draw[->](0,-.5)--(0,2);
        \draw[black!40](B)--($(A)+(\DD:4)$);
        % yield surface
        \coordinate(A)at(\Ax,\Ay);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(A){};
        \draw[dashed,draw,line width=.3mm](A)circle(4cm);
        \draw[<-]($(A)+(60:4)$)--++(60:1.4)--++(1,0)node[right,fill=white]{yield surface $f$};
        % similarity centre
        \coordinate(B)at(\Bx,\By);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(B){};
        \draw[dotted,red,line width=.4mm]($(B)!2.5!(A)$)--($(A)!1.5!(B)$)node[black,right,align=left]{centre of the subloading\\surface must lie on this\\fixed line};
        % current subloading surface
        \coordinate(C)at($(A)!0.375!(B)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(C){};
        \draw[draw,line width=.6mm](C)circle(2.5cm);
        \draw[<-]($(C)+(60:2.5)$)--++(60:1.7)--++(.5,0)node[right,fill=white]{current subloading surface};
        \coordinate(D)at($(C)+(\DD:2.5)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(D){};
        % bigger subloading surface
        \coordinate(CB)at($(A)!0.175!(B)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(CB){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at($(CB)+(\DD:3.3cm)$){};
        \draw[|<->|](CB)--++(\DD:3.3)node[midway,fill=white,sloped]{$z\uparrow$};
        \draw[black!40,draw,line width=.6mm](CB)circle(3.3);
        % smaller subloading surface
        \coordinate(CS)at($(A)!0.575!(B)$);
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at(CS){};
        \node[fill=black,circle,inner sep=0,minimum size=2mm]at($(CS)+(\DD:1.7cm)$){};
        \draw[|<->|](CS)--++(\DD:1.7)node[midway,fill=white,sloped]{$z\downarrow$};
        \draw[black!40,draw,line width=.6mm](CS)circle(1.7);
        % arrows
        \draw[->,red,line width=1mm](0,0)--(A)node[midway,fill=white,sloped]{$\bbeta=H\balpha$};
        \draw[->,red,line width=1mm](A)--(C);
        \draw[->,red,line width=1mm](C)--(D)node[midway,fill=white,sloped]{$\beeta$};
        \draw[<-]($(A)!0.3!(C)$)--++(-60:2)--++(2.5,0)node[right,fill=white]{$\left(1-z\right)F\bd$};
        \draw[dotted,line width=.4mm]($(D)+(180:6)$)--($(D)+(0:2)$)node[right,align=left]{search along the loading\\direction to minimise $z$};
        \draw[->,blue,line width=1mm](D)--++(180:2.8)node[fill=black,circle,inner sep=0,minimum size=2mm]{};
        \draw[<-]($(D)+(180:2)$)--++(135:2.5)--++(-1,0)node[left,align=right]{load increment $\Delta\bs$\\$z$ decreases first\\then increases};
    \end{tikzpicture}
    \caption{arbitrary loading direction with frozen plasticity}\label{fig:loading_criterion}
\end{figure}

In the trial state, by freezing plasticity, viz., $H$, $F$, $\balpha$ and $\bd$ are all kept constant, it can be concluded that the centre of the subloading surface must lie on the line defined by centre of the yield surface $\bbeta$ and the elastic core $\bc=\bbeta+F\bd$.
Then, for a given load increment $\Delta\bs$, assuming proportional loading, there exists a scalar $r$ such that the corresponding stress state $\bs_n+r\Delta\bs$ would minimise $z$, we denote this $z$ as $z^\text{trial}$ since it is computed in the trial state.
In mathematical terms, it can be expressed as
\begin{gather}
    \min\limits_{r\in\mathbb{R}}z^\text{trial}\left(r\right),
\end{gather}
where $z^\text{trial}$ shall be computed by enforcing the corresponding $f_s^\text{trial}=0$.
\begin{gather}\label{eq:trial_criterion}
    \begin{split}
        f_s^\text{trial} & =\norm{\beeta^\text{trial}}-z^\text{trial}F_n                                                 \\
                         & =\norm{\bs_n+r\Delta\bs-H_n\balpha_n+\left(z^\text{trial}-1\right)F_n\bd_n}-z^\text{trial}F_n \\
                         & =\norm{\bar{\beeta}+z^\text{trial}F_n\bd_n}-z^\text{trial}F_n                                 \\
                         & =0,
    \end{split}
\end{gather}
in which $\bar{\beeta}=\bar{\beeta}\left(r\right)=\bs_n-H_n\balpha_n-F_n\bd_n+r\Delta\bs$.
The subscript $\left(\cdot\right)_n$ denotes the converged state at the beginning of the current loading step.
Since no extra constraints are imposed on $r$ for the moment, a solution is guaranteed to exist.
However, there are three cases.
\begin{enumerate}
    \item If $0<r<1$, the given load increment $\Delta\bs$ contains both elastic unloading and plastic loading.
          Since the elastic unloading portion reduces $z$ to a value smaller than the converged $z_n$, the plastic loading portion shall use this smaller $z$, instead of $z_n$, as the starting value to correctly compute plasticity development.
    \item If $r\geqslant1$, the given load increment $\Delta\bs$ involves only elastic unloading.
    \item If $r\leqslant0$, it is a pure (un)loading case. Nothing additional needs to be done. $z_n$ is the correct starting value for return mapping.
\end{enumerate}

Noting that $f_s^\text{trial}=0$ implies
\begin{gather}
    \left(\bar{\beeta}+z^\text{trial}F_n\bd_n\right):\left(\bar{\beeta}+z^\text{trial}F_n\bd_n\right)=\left(z^\text{trial}\right)^2F_n^2,
\end{gather}
which is effectively,
\begin{gather}
    \bar{\beeta}:\bar{\beeta}+2F_n\bar{\beeta}:\bd_nz^\text{trial}+F_n^2\left(\bd_n:\bd_n-1\right)\left(z^\text{trial}\right)^2=0.
\end{gather}
By the quadratic formula,
\begin{gather}\label{eq:z_trial}
    z^\text{trial}\left(r\right)=\dfrac{\bar{\beeta}:\bd_n+\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(1-\bd_n:\bd_n\right)}}{F_n\left(1-\bd_n:\bd_n\right)}.
\end{gather}
Noting that $\norm{\bd_n}<z_e\leqslant1$, then, $1-\bd_n:\bd_n>0$, thus, the denominator is positive.
Due to the same reason, $\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(1-\bd_n:\bd_n\right)}>\abs{\bar{\beeta}:\bd_n}$.
The other root is discarded since it may be negative.

To minimise $z^\text{trial}$, which is a univariate function of $r$ in the trial state, one could derive
\begin{gather}
    \ddfrac{z^\text{trial}}{r}=0\quad\rightarrow\quad
    \ddfrac{}{r}\left(\bar{\beeta}:\bd_n+\sqrt{\left(\bar{\beeta}:\bd_n\right)^2+\left(\bar{\beeta}:\bar{\beeta}\right)\left(1-\bd_n:\bd_n\right)}\right)=0.
\end{gather}
Its explicit form can be further expressed as follows,
\begin{gather}
    \bd_n:\Delta\bs+\dfrac{\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right)}{\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}}=0,
\end{gather}
which, in a general context, can be solved by the Newton--Raphson method.

Let $R_r$ denote the residual
\begin{multline}\label{eq:z_residual}
    R_r=\left(\bd_n:\Delta\bs\right)\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}\\
    +\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right).
\end{multline}
It's derivative with regard to $r$ is
\begin{multline}\label{eq:z_derivative}
J_r=\ddfrac{R_r}{r}=\left(\bd_n:\Delta\bs\right)\dfrac{\left(\bd_n:\bar{\beeta}\right)\left(\bd_n:\Delta\bs\right)+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\Delta\bs\right)}{\sqrt{\left(\bd_n:\bar{\beeta}\right)^2+\left(1-\bd_n:\bd_n\right)\left(\bar{\beeta}:\bar{\beeta}\right)}}\\
    +\left(\bd_n:\Delta\bs\right)^2+\left(1-\bd_n:\bd_n\right)\left(\Delta\bs:\Delta\bs\right).
\end{multline}

Compared to the recent work \citep[e.g.,][]{Hashiguchi2018,Anjiki2019}, here we have presented an equivalent but simpler approach to compute the starting normal yield ratio for arbitrary loading increments.
One shall note that it is based on the general form \eqsref{eq:trial_criterion}.
For specific cases as presented later, the expressions may be different.
\algoref{algo:loading_criterion} presents a general algorithm to detect partial elastic unloading and correct the starting value of the normal yield ratio if necessary.
\begin{breakablealgorithm}
    \caption{correct starting value of normal yield ratio $z$}\label{algo:loading_criterion}
    \begin{algorithmic}[1]
        \State \textbf{Input}: $\bsigma^\text{trial}$, $\bsigma_n$, $\balpha_{n}$, $\bd_n$, $q_n$, $z_n$
        \State \textbf{Output}: $r$
        \State compute $\Delta\bs=\bs^\text{trial}-\bs_n$ using $\bsigma^\text{trial}$ and $\bsigma_n$
        \State $r=0$
        \While{true}
        \State $\bar{\beeta}=\bar{\beeta}\left(r\right)=\bs_n-H_n\balpha_n-F_n\bd_n+r\Delta\bs$
        \State formulate $R_r$ and $J_r$\Comment{\eqsref{eq:z_residual}, \eqsref{eq:z_derivative}}
        \State $\delta{}r=R_r/J_r$
        \If{$\abs{\delta{}r}<\text{tolerance}$}
        \If{$0<r<1$}\Comment{current loading increment contains elastic unloading}
        \State update $z_{n}=z^\text{trial}$\Comment{compute $z^\text{trial}$ using $r$ via \eqsref{eq:z_trial}}
        \EndIf
        \State \textbf{return} $r$
        \EndIf
        \State $r\leftarrow{}r-\delta{}r$
        \EndWhile
    \end{algorithmic}
\end{breakablealgorithm}
\subsection{A von Mises Material Model}
In the following, we present discrete expressions under the von Mises framework.
\subsubsection{Subloading Surface}
For the von Mises criterion, $\bs$ shall take the deviatoric part of the stress tensor $\bs=\dev{\bsigma}$, then
\begin{gather}
    \beeta=\dev{\bsigma}-H\balpha+\left(z-1\right)F\bd.
\end{gather}
The subloading surface shall be expressed as follows by replacing $F$ with $\sqrt{\dfrac{2}{3}}\sigma^y$.
\begin{gather}
    f_s=\norm{\beeta}-z\sqrt{\dfrac{2}{3}}\sigma^y.
\end{gather}
\subsubsection{Flow Rule}
Assuming associative plasticity, the flow rule is given by
\begin{gather}\label{eq:subloading_flow}
    \dot{\bvarepsilon^p}=\gamma\pdfrac{f_s}{\bsigma}=\gamma\dfrac{\beeta}{\norm{\beeta}}=\gamma\bn,
\end{gather}
where $\gamma$ denotes the plastic multiplier.
\subsubsection{Evolution Rules}
\paragraph{Accumulated Plastic Strain}
The accumulated plastic strain $q$ simply takes the accumulated magnitude of $\bvarepsilon^p$, thus, its rate form is
\begin{gather}\label{eq:eqv_strain}
    \dot{q}=\sqrt{\dfrac{2}{3}}\norm{\dot{\bvarepsilon^p}}=\sqrt{\dfrac{2}{3}}\gamma.
\end{gather}
\paragraph{Isotropic Hardening}
The evolution of $\sigma^y$ depends on $q$, here we adopt general form that combines linear hardening and nonlinear saturation.
\begin{gather}\label{eq:iso_bone}
    \sigma^y=\sigma^i+k_\text{iso}q+\sigma^s_\text{iso}\left(1-e^{-m^s_\text{iso}q}\right),
    \end{gather}
    where $\sigma^i$ is the initial yield stress, $k_\text{iso}$ is the isotropic hardening modulus, $\sigma^s_\text{iso}$ is the saturation stress, and $m^s_\text{iso}$ is the saturation rate.
    \paragraph{Kinematic Hardening}
    The kinematic hardening bound $H$ is replaced with a discrete function $a^y$ that takes a similar form to $\sigma^y$,
    \begin{gather}\label{eq:kin_bone}
        a^y=a^i+k_\text{kin}q+a^s_\text{kin}\left(1-e^{-m^s_\text{kin}q}\right),
    \end{gather}
    where $a^i$ is the initial stress, $k_\text{kin}$ is the kinematic hardening modulus, $a^s_\text{kin}$ is the saturation stress, and $m^s_\text{kin}$ is the saturation rate.
    
    The normalised back stress $\balpha$ adopts an Armstrong--Frederick type \citep{Frederick2007} evolution rule as shown in \eqsref{eq:revised_back}.
    \begin{gather}
        \dot{\balpha}=b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma.
    \end{gather}
    \paragraph{Elastic Core}
    The new field $\bd$ also adopts an Armstrong--Frederick type evolution rule as shown in \eqsref{eq:revised_core}.
    \begin{gather}
    \dot{\bd}=c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma.
\end{gather}
\subsubsection{Summary}
The key expressions for both uniaxial and 3D models are summarised in \tabref{tab:summary}.
Note the constant $\sqrt{\dfrac{2}{3}}$ is added to the evolution rules for $\alpha$ and $d$ in the uniaxial version to ensure the same set of parameters used for both models would yield the same results.
They can be removed if such a consistency is not required.
\begin{table}[htb]
    \centering
    \caption{Summary of the subloading surface model}\label{tab:summary}
    \begin{tabular}{rll}
        \toprule
                           & uniaxial                                                                                                     & 3D                                                                 \\\midrule
        Constitutive Law   & $\sigma=E\left(\varepsilon-\varepsilon^p\right)$                                                             & $\bsigma=\mb{D}_e\left(\bvarepsilon-\bvarepsilon^p\right)$           \\
        Subloading Surface & $f_s=\abs{\eta}-z\sigma^y$                                                                                   & $f_s=\norm{\beeta}-z\sqrt{\dfrac{2}{3}}\sigma^y$                   \\
                           & $\eta=\sigma-a^y\alpha+\left(z-1\right)\sigma^yd$                                                            & $\beeta=\dev{\bsigma}-a^y\balpha+\left(z-1\right)\sigma^y\bd$      \\
        Flow Rule          & $\dot{\varepsilon^p}=\gamma{}n$                                                                              & $\dot{\bvarepsilon^p}=\gamma{}\bn$                                 \\
                           & $n=\sign{\eta}$                                                                                              & $\bn=\pdfrac{f_s}{\bsigma}/\norm{\pdfrac{f_s}{\bsigma}}$           \\
        Evolution Laws     & $\dot{q}=\gamma$                                                                                             & $\dot{q}=\sqrt{\dfrac{2}{3}}\gamma$                                \\
                           & $\dot{\alpha}=\sqrt{\dfrac{2}{3}}b\left(n-\alpha\right)\gamma$                                               & $\dot{\balpha}=b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma$ \\
                           & $\dot{d}=\sqrt{\dfrac{2}{3}}c_e\left(z_en-d\right)\gamma$                                                    & $\dot{\bd}=c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma$    \\
                           & \multicolumn{2}{l}{$\dot{z}=U\dot{q}$}                                                                                                                                            \\
                           & \multicolumn{2}{l}{$\sigma^y=\sigma^i+k_\text{iso}q+\sigma^s_\text{iso}\left(1-e^{-m^s_\text{iso}q}\right)$}                                                                      \\
                           & \multicolumn{2}{l}{$a^y=a^i+k_\text{kin}q+a^s_\text{kin}\left(1-e^{-m^s_\text{kin}q}\right)$}                                                                                     \\\bottomrule
    \end{tabular}
\end{table}
\subsection{Numerical Implementation}
\subsubsection{Some Simplifications}
Noting that $\dot{\balpha}$ is a linear function of $\balpha$, taking advantage of the implicit Euler method, one could express $\balpha$ in its explicit form.
\begin{gather}\label{eq:explicit_alpha}
    \balpha_n+b\left(\sqrt{\dfrac{2}{3}}\bn-\balpha\right)\gamma=\balpha\qquad\rightarrow\qquad
    \balpha=\dfrac{\gamma\sqrt{\dfrac{2}{3}}b\bn+\balpha_n}{1+\gamma{}b}.
    \end{gather}
    Similarly, $\bd$ can be expressed as
    \begin{gather}\label{eq:explicit_d}
        \bd_n+c_e\left(\sqrt{\dfrac{2}{3}}z_e\bn-\bd\right)\gamma=\bd\qquad\rightarrow\qquad\bd=\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}c_ez_e\bn+\bd_n}{1+\gamma{}c_e}.
    \end{gather}
    On the other hand, the deviatoric stress $\bs$ shall be computed via the trial stress $\bsigma^\text{trial}$,
    \begin{gather}
    \bs=\dev{\bsigma}=\dev{\bsigma^\text{trial}-\gamma2G\bn}=\dev{\bsigma^\text{trial}}-\gamma2G\bn=\bs^\text{trial}-\gamma2G\bn.
\end{gather}

The shifted stress $\beeta$ is then
\begin{gather}\label{eq:explicit_eta}
    \begin{split}
        \beeta & =\bs-a^y\balpha+\left(z-1\right)\sigma^y\bd                                                                                                                                                \\
               & =\bs^\text{trial}-\gamma2G\bn-a^y\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}b\bn+\balpha_n}{1+\gamma{}b}+\left(z-1\right)\sigma^y\dfrac{\gamma{}\sqrt{\dfrac{2}{3}}c_ez_e\bn+\bd_n}{1+\gamma{}c_e}.
    \end{split}
\end{gather}
Rearranging gives
\begin{multline}
    \beeta+\gamma2G\bn+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}\bn+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\bn=\\\bs^\text{trial}-\dfrac{a^y}{1+\gamma{}b}\balpha_n+\left(z-1\right)\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n.
\end{multline}
One could denote
\begin{gather}\label{eq:zeta}
    \bzeta=\bs^\text{trial}-\dfrac{a^y}{1+\gamma{}b}\balpha_n+\left(z-1\right)\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n,
\end{gather}
such that
\begin{gather}
        \left(\norm{\beeta}+\gamma2G+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\right)\bn=\bzeta.
        \end{gather}
    It can be noted that each term in the bracket is non-negative by definition, thus it is correct to conclude that
    \begin{gather}\label{eq:zeta_norm}
    \norm{\beeta}+\gamma2G+\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}=\norm{\bzeta},
\end{gather}
and
\begin{gather}
    \bn=\dfrac{\beeta}{\norm{\beeta}}=\dfrac{\bzeta}{\norm{\bzeta}}.
\end{gather}
Although it is not possible to simplify more, one shall realise that $\bzeta$ is a function of $\bvarepsilon$, $\gamma$ and $z$ only.
Its derivatives can be computed as follows.
\begin{gather}\label{eq:zeta_d1}
\pdfrac{\bzeta}{\gamma}=-\dfrac{\ddfrac{a^y}{\gamma}\left(1+\gamma{}b\right)-ba^y}{\left(1+\gamma{}b\right)^2}\balpha_n+\left(z-1\right)\dfrac{\ddfrac{\sigma^y}{\gamma}\left(1+\gamma{}c_e\right)-c_e\sigma^y}{\left(1+\gamma{}c_e\right)^2}\bd_n,\\\label{eq:zeta_d2}
\pdfrac{\bzeta}{z}=\dfrac{\sigma^y}{1+\gamma{}c_e}\bd_n,\\\label{eq:zeta_d3}
    \pdfrac{\bzeta}{\bvarepsilon}=2G\mathbb{I}_\text{dev}.
\end{gather}
The above simplifications are valid under the assumption of associative plasticity flow.
\subsubsection{Local System}
The local system consists of two residuals, $f_s$ and $z$.
\begin{gather}
    \mb{R}=\left\{
    \begin{array}{l}
        \norm{\beeta}-\sqrt{\dfrac{2}{3}}z\sigma^y, \\[2mm]
        z-z_n-\sqrt{\dfrac{2}{3}}U\gamma.
    \end{array}
    \right.
\end{gather}
Taking the local variable as $\mb{x}=\begin{bmatrix}
        \gamma & z
    \end{bmatrix}^\mT$, the Jacobian $\mb{J}$ shall be written as
\begin{gather}
    \mb{J}=\begin{bmatrix}
        \pdfrac{\norm{\beeta}}{\gamma}-\sqrt{\dfrac{2}{3}}z\ddfrac{\sigma^y}{\gamma} & \pdfrac{\norm{\beeta}}{z}-\sqrt{\dfrac{2}{3}}\sigma^y \\[4mm]
        -\sqrt{\dfrac{2}{3}}U                                                        & 1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}
    \end{bmatrix}.
\end{gather}
It is possible to avoid cumbersome computation of derivatives of $\norm{\beeta}$ by taking advantage of \eqsref{eq:zeta_norm}.
By noting that the derivatives of $\norm{\bzeta}$ can be further expanded as
\begin{gather}
    \pdfrac{\norm{\bzeta}}{}=\bn:\pdfrac{\bzeta}{},
\end{gather}
then
\begin{gather}\label{eq:eta_d1}
\pdfrac{\norm{\beeta}}{\gamma}=\bn:\pdfrac{\bzeta}{\gamma}-2G-\pdfrac{}{\gamma}\left(\sqrt{\dfrac{2}{3}}b\dfrac{\gamma{}a^y}{1+\gamma{}b}+\sqrt{\dfrac{2}{3}}c_ez_e\left(1-z\right)\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}\right),\\\label{eq:eta_d2}
    \pdfrac{\norm{\beeta}}{z}=\bn:\pdfrac{\bzeta}{z}+\sqrt{\dfrac{2}{3}}c_ez_e\dfrac{\gamma{}\sigma^y}{1+\gamma{}c_e}.
\end{gather}
\subsubsection{Consistent Tangent Operator}
It is possible to differentiate the local equilibrium $\mb{R}=\mb{0}$ to obtain
\begin{gather}
    \pdfrac{\mb{R}}{\bvarepsilon}+\pdfrac{\mb{R}}{\mb{x}}\ddfrac{\mb{x}}{\bvarepsilon}=\mb{0}.
\end{gather}
This gives
\begin{gather}\label{eq:local_equilibrium}
    \ddfrac{\mb{x}}{\bvarepsilon}=-\left(\pdfrac{\mb{R}}{\mb{x}}\right)^{-1}\pdfrac{\mb{R}}{\bvarepsilon}=-\mb{J}^{-1}\pdfrac{\mb{R}}{\bvarepsilon}.
\end{gather}
Noting that
\begin{gather}
    \pdfrac{\norm{\beeta}}{\bvarepsilon}=\bn:\pdfrac{\bzeta}{\bvarepsilon}=2G\bn:\mathbb{I}_\text{dev}=2G\bn,
\end{gather}
then in the matrix form,
\begin{gather}
    \pdfrac{\mb{R}}{\bvarepsilon}=2G\begin{bmatrix}
        \bn^\mT \\\mb{0}
    \end{bmatrix}.
\end{gather}
By solving \eqsref{eq:local_equilibrium}, one could obtain $\ddfrac{\mb{x}}{\bvarepsilon}$, we are interested in the first row, which can be explicitly written as
\begin{gather}
    \ddfrac{\gamma}{\bvarepsilon}=-2G\dfrac{1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}}{\det\mb{J}}\bn^\mT.
\end{gather}
Now from the stress update expression $\bsigma=\bsigma^\text{trial}-\gamma2G\bn$, it is possible to derive the consistent tangent operator as
\begin{gather}
    \ddfrac{\bsigma}{\bvarepsilon}=\mb{D}_e-2G\left(\pdfrac{\bn}{\bvarepsilon}\gamma+\bn\ddfrac{\gamma}{\bvarepsilon}\right),
\end{gather}
where $\mb{D}_e$ is the elastic stiffness.
In the meantime, by $\bn=\dfrac{\bzeta}{\norm{\bzeta}}$, the derivative of $\bn$ with respect to $\bvarepsilon$ can be shown as
\begin{gather}
    \pdfrac{\bn}{\bvarepsilon}=\dfrac{2G}{\norm{\bzeta}}\left(\mathbb{I}_\text{dev}-\bn\bn^\mT\right),
\end{gather}
after some algebra, the consistent tangent operator can be written as
\begin{gather}\label{eq:consistent_tangent}
\ddfrac{\bsigma}{\bvarepsilon}=\mb{D}_e-\dfrac{4G^2\gamma}{\norm{\bzeta}}\mathbb{I}_\text{dev}+4G^2\left(\dfrac{\gamma}{\norm{\bzeta}}+\dfrac{1-\sqrt{\dfrac{2}{3}}\gamma{}\ddfrac{U}{z}}{\det\mb{J}}\right)\bn\bn^\mT.
\end{gather}
\subsubsection{A Reference Algorithm}
The complete algorithm is presented in \algoref{algo:subloading_steel}.
It adopts a standard Newton--Raphson scheme to solve the local equilibrium.
Noting that the local iteration does not involve complex tensor algebra, the algorithm can be implemented in a very efficient and concise manner.
\begin{breakablealgorithm}
    \caption{state determination of the subloading surface model}\label{algo:subloading_steel}
    \begin{algorithmic}[1]
        \State \textbf{Parameter}: $E$, $\nu$, $\sigma^i$, $k_\text{iso}$, $\sigma^s_\text{iso}$, $m^s_\text{iso}$, $a^i$, $k_\text{kin}$, $a^s_\text{kin}$, $m^s_\text{kin}$, $b$, $u$, $c_e$, $z_e$
        \State \textbf{Input}: $\bvarepsilon_{n+1}$, $\bvarepsilon_n$, $\bsigma_n$, $\balpha_{n}$, $\bd_n$, $q_n$, $z_n$
        \State \textbf{Output}: $\mb{D}_{n+1}$, $\bsigma_{n+1}$, $\balpha_{n+1}$, $\bd_{n+1}$, $q_{n+1}$, $z_{n+1}$
        \State compute trial stress $\bsigma^\text{trial}=\bsigma_n+\mb{D}_e\left(\bvarepsilon_{n+1}-\bvarepsilon_n\right)$\Comment{$\mb{D}_e$: elastic stiffness}
        \State set history variables $\left(\cdot\right)_{n+1}=\left(\cdot\right)_{n}$ for $\balpha_{n+1}$, $\bd_{n+1}$, $q_{n+1}$, $z_{n+1}$
        \State check loading criterion and correct $z_n$ if necessary\Comment{\algoref{algo:loading_criterion}}
        \If{$r\geqslant1$}\Comment{elastic unloading}
        \State $\bsigma_{n+1}=\bsigma^\text{trial}$
        \State $\mb{D}_{n+1}=\mb{D}_e$
        \State update $z$ by solving $\norm{\bs_{n+1}-a^y_{n+1}\balpha_{n+1}+\left(z-1\right)\sigma^y_{n+1}\bd_{n+1}}=\sqrt{\dfrac{2}{3}}z\sigma^y_{n+1}$\Comment{$0\leqslant{}z\leqslant1$}
        \State \textbf{return}
        \EndIf
        \State $\gamma=0$\Comment{plastic multiplier}
        \While{true}
        \State update $q_{n+1}$ according to $\gamma$\Comment{\eqsref{eq:eqv_strain}}
        \State update $a^y_{n+1}$ and $\sigma^y_{n+1}$ according to $q_{n+1}$\Comment{\eqsref{eq:iso_bone}, \eqsref{eq:kin_bone}}
        \State compute $\bzeta_{n+1}$ and $\bn_{n+1}$\Comment{\eqsref{eq:zeta}}
        \State update $\balpha_{n+1}$, $\bd_{n+1}$\Comment{\eqsref{eq:explicit_alpha}, \eqsref{eq:explicit_d}}
        \State formulate $\mb{R}$\Comment{$\norm{\beeta}$ can be directly computed using \eqsref{eq:explicit_eta}}
        \State formulate $\mb{J}$\Comment{\eqsref{eq:eta_d1} via \eqsref{eq:zeta_d1}, \eqsref{eq:eta_d2} via \eqsref{eq:zeta_d2}}
        \State $\Delta=\mb{J}^{-1}\mb{R}$\Comment{$\Delta=\begin{bmatrix}\delta\gamma&\delta{}z\end{bmatrix}$}
        \If{$\norm{\Delta}<\text{tolerance}$}
        \State compute stress $\bsigma_{n+1}=\bsigma^\text{trial}-\gamma2G\bn_{n+1}$\Comment{$G$: shear modulus}
        \State compute consistent tangent stiffness $\mb{D}_{n+1}$\Comment{\eqsref{eq:consistent_tangent}}
        \State \textbf{return}
        \EndIf
        \State $\gamma\leftarrow\gamma-\delta\gamma$
        \State $z\leftarrow{}z-\delta{}z$
        \EndWhile
    \end{algorithmic}
\end{breakablealgorithm}
\subsubsection{Remarks}
Compared to the previous implementation \citep{Anjiki2019}, the formulation proposed in this work dramatically reduces the size of local system from \num{20} to \num{2}.
We also present the explicit expression of the consistent tangent operator.
If \eqsref{eq:original_z} can be explicitly integrated by choosing a specific function $U$ (such as the cotangent function used in the original proposal), the local system can be further reduced to a scalar residual.
\subsection{Selection of $U\left(z\right)$}
The function $U\left(z\right)$ shall satisfy the following conditions.
\begin{gather}
    U\left(z\right)=\left\{
    \begin{array}{ll}
        +\infty, & z=0, \\
        >0,      & z<1, \\
        =0,      & z=1, \\
        <0,      & z>1.
    \end{array}\right.
\end{gather}
Three candidates are proposed \citep{Hashiguchi2017}, all contain a parameter $u$ to control the evolution rate.
\begin{gather}
    U\left(z\right)=u\cot\left(\dfrac{\pi}{2}z\right),\qquad
    U\left(z\right)=-u\ln\left(z\right),\qquad
    U\left(z\right)=u\left(\dfrac{1}{z}-1\right).
\end{gather}
The cotangent function is deemed `most beneficial' as $z$ can be explicitly integrated.
However, it may not be the most numerically stable choice.

It is clear that by construct, the subloading surface model ensures that the tangent stiffness satisfies the smoothness condition, that is, it is continuous. The corresponding potential function shall possess at least $C^2$ continuity.
We are interested in whether such a continuous condition is achievable numerically.
Furthermore, if it indeed can be achieved, is such a continuous condition really beneficial in terms of numerical performance.
Here we discuss these problems by exploring the explicit expression for the tangent stiffness.

For brevity, assuming no hardening and no elastic core, and $U\left(z\right)$ takes a general form, then the Jacobian (for the uniaxial model) could be simplified to
\begin{gather}
    \mb{J}=\begin{bmatrix}
        -E & -\sigma^y    \\[2mm]
        -U & 1-\gamma{}U'
    \end{bmatrix}.
\end{gather}
The tangent stiffness shall be then expressed as
\begin{gather}
    \ddfrac{\sigma}{\varepsilon}=E-\dfrac{E^2}{E\left(1-\gamma{}U'\right)+U\sigma^y}\left(1-\gamma{}U'\right)=E-\dfrac{E}{1+\dfrac{U\sigma^y}{E\left(1-\gamma{}U'\right)}}.
\end{gather}
Given that we are interested in the very first step from $z_n=0$ to some non-zero value, then
\begin{gather}
    \gamma=\dfrac{z-z_n}{U}=\dfrac{z-0}{U}=\dfrac{z}{U},
\end{gather}
also since $\sigma^y/E$ is a constant, we shall focus on the following limit,
\begin{gather}\label{eq:weak_limit}
    \lim\limits_{z\to0^+}\dfrac{U}{1-\gamma{}U'}=\lim\limits_{z\to0^+}\dfrac{U}{1-z\dfrac{U'}{U}}=\lim\limits_{z\to0^+}\dfrac{U^2}{U-zU'}.
\end{gather}
If it converges to infinity, then the tangent stiffness is continuous around $z=0$.
\subsubsection{A `Not-So-Ideal' Choice}
Now if one chooses $U\left(z\right)=-u\ln\left(z\right)$ so that $U'\left(z\right)=-u/z$, then
\begin{gather}
    \lim\limits_{z\to0^+}\dfrac{U^2}{U-zU'}=\lim\limits_{z\to0^+}\dfrac{u^2\ln^2\left(z\right)}{-u\ln\left(z\right)+u}=\lim\limits_{z\to0^+}\dfrac{2u\ln\left(z\right)/z}{-1/z}=\lim\limits_{z\to0^+}-u\ln\left(z\right)=\infty.
\end{gather}
Thus,
\begin{gather}
    \lim\limits_{z\to0^+}\ddfrac{\sigma}{\varepsilon}=E.
\end{gather}
This proves that the tangent stiffness is continuous at $z=0$.

However, noting that $\dfrac{U^2}{U-zU'}=-u\ln\left(z\right)$ quickly departs away from infinity, this continuity cannot be achieved numerically.
For example, on platforms with the double precision (64-bit), the interval machine epsilon is $2^{-52}$, thus, $-\ln\left(2^{-52}\right)\approx\num{36}$.
\subsubsection{A `Better' Choice}
One can also follow the recommendation and choose the cotangent function $U\left(z\right)=u\cot\left(\dfrac{\pi}{2}z\right)$ so that $U'\left(z\right)=-\dfrac{u\pi}{2}\csc^2\left(\dfrac{\pi}{2}z\right)$, then
\begin{gather}
    \lim\limits_{z\to0^+}\dfrac{U^2}{U-zU'}=\lim\limits_{z\to0^+}u\dfrac{\cos\left(\pi{}z\right)+1}{\sin\left(\pi{}z\right)+\pi{}z}=\infty.
\end{gather}
For $z\approx\num{e-16}$, it reaches $\approx\num{e16}$.
This effectively results in a continuous tangent stiffness around $z=0$.
Hence the cotangent function presents a `nicer' behaviour as it is more aligned with the intended continuity requirement.

Based on the above discussion, to ensure numerical continuity, it is necessary to further impose the following condition,
\begin{gather}\label{eq:continuity}
    \lim\limits_{z\to0^+}\dfrac{zU^2}{U-zU'}\neq0.
\end{gather}
We call \eqsref{eq:weak_limit} the `weak numerical continuity condition' and \eqsref{eq:continuity} the `strong numerical continuity condition'.
It can be validated that the cotangent function satisfies this condition.
Noting that \eqsref{eq:continuity} is obtained from a discretised system with $z$ being integrated by the implicit Euler method, for other methods, such as the trapezoidal rule, the specific form of this condition may vary.
\subsubsection{Is `Good' Really Good?}
Functions that meet the strong numerical continuity condition are not necessarily the best choice.
It is typically expected that it shall be `easier' to solve the system with a smaller step size.
However, this is not the case with functions that satisfy \eqsref{eq:continuity}.
Loading from $z_n=0$ to some non-zero value would be more difficult, if not impossible, with a smaller step size as the Jacobian quickly becomes ill-conditioned.

To illustrate, we consider the reciprocal condition number of the following Jacobian,
\begin{gather}
    \mb{J}=\begin{bmatrix}
        1 & 1                \\[2mm]
        U & z\dfrac{U'}{U}-1
    \end{bmatrix}.
\end{gather}
It can be seen from \figref{fig:rcond} that with a smaller $z$ (which is effectively the increment $\Delta{}z$ when loading from $z_n=0$), functions such as $1/z$ and $\cot\left(z\right)$ result in an ill-conditioned system that is numerically difficult to solve.
This often causes the local divergence.
\begin{figure}
    \centering\footnotesize
    \begin{tikzpicture}
        \begin{axis}[
                xlabel={$z$},
                ylabel={$\text{rcond}\left(\mb{J}\right)$},
                legend pos=south east,
                grid=major,
                width=7cm,
                height=4.5cm,
                xmode=log,
                ymode=log,
                xmin=1e-16,
                xmax=1e-1,
                scale only axis,
                enlargelimits=false,
            ]
            \addplot[mark=*, color=blue] table [x index=0, y index=1, col sep=space] {SCRIPT/pow3.txt};
            \addlegendentry{$z^{-0.2}$}
            \addplot[mark=square*, color=red] table [x index=0, y index=1, col sep=space] {SCRIPT/pow.txt};
            \addlegendentry{$z^{-0.5}$}
            \addplot[mark=triangle*, color=green] table [x index=0, y index=1, col sep=space] {SCRIPT/pow2.txt};
            \addlegendentry{$z^{-1}$}
            \addplot[mark=diamond*, color=purple] table [x index=0, y index=1, col sep=space] {SCRIPT/log.txt};
            \addlegendentry{$-\ln\left(z\right)$}
            \addplot[mark=o, color=orange] table [x index=0, y index=1, col sep=space] {SCRIPT/cot.txt};
            \addlegendentry{$\cot\left(z\right)$}
        \end{axis}
    \end{tikzpicture}
    \caption{reciprocal condition number of the Jacobian}\label{fig:rcond}
\end{figure}
When such a divergence occurs, sub-stepping would only make the system even more different to solve.
It means, with functions that satisfy the strong numerical continuity condition, there exists a lower bound for the step size.

Now, we shall ask the following question: what kind of functions shall be used?
From the perspective of numerical robustness/stability, it appears to be better to choose functions that satisfy the weak numerical continuity condition only.
That is,
\begin{gather}
    \lim\limits_{z\to0^+}\dfrac{U^2}{U-zU'}=\infty\qquad\text{and}\qquad\lim\limits_{z\to0^+}\dfrac{zU^2}{U-zU'}=0.
\end{gather}

It can be validated that the power function
\begin{gather}
    U\left(z\right)=u\left(z^{-n}-1\right)\qquad\text{for}\qquad{}0<n
\end{gather}
satisfies the weak condition.
It is analytically continuous for all valid $n$.
For $n\geqslant1$, it also satisfies the strong condition.
However, when $n>1$, it is even less numerically stable thus shall not be considered.
For $n<1$, it shows a similar behaviour to the logarithmic function, that is, does not present the ideal numerical continuity but is more numerically stable.

Based on the above discussion, the recommendation shall be revised to choose the following function instead.
\begin{gather}
    U\left(z\right)=u\left(z^{-n}-1\right)\qquad\text{for}\qquad{}0<n\leqslant1.
\end{gather}
The exponent $n$ can be a user input parameter such that the balance between numerical stability and continuity can be adjusted on demand.